<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Tree Populations vs. Air Quality, Neighborhood by Neighborhood</title>
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
  <%- include ('global/header');  %>
  <%- include ('global/navbar');  %>
  <table>
  <tr>
    <th>Community District</th>
    <th>Neighborhood</th>
    <th>Air Quality</th>
    <th>Tree Count</th>
  </tr>
  <tr>
    <td><%= data2.CDID %></td>
    <td><%= data2.neigborhood_name %></td>
    <td><%= data2.air_quality %></td>
    <td><%= data2.treeCount %></td>
  </tr>
</table>
<script type = "text/javascript" src="doughnutChart.js"></script>

<script>
var margin = {top: 20, right: 20, bottom: 60, left: 80},
     width = 500 - margin.left - margin.right,
     height = 500 - margin.top - margin.bottom;
var data = [
  {language:  "<%= data2.air_quality %>", value: Number(<%= data2.air_quality %>)},
  {language:  "", value: 50-Number(<%= data2.air_quality %>)},];
colors=["#228B22","#A9A9A9","#00CDAC","#FFA23A","#74737A"]
var svg = d3.select("body") //create Svg element
   .append("svg")
   .attr('width', width + margin.right + margin.left)
   .attr('height', height + margin.top + margin.bottom)
   .style("border", "solid 1px red")
    .attr("transform","translate(200,0)");
var chart=svg.append('g')
   .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
   .attr('width', width)
   .attr('height', height)
var pie=d3.pie()
        .value(d => d.value)
var color_scale=d3.scaleOrdinal()
              .domain(data.map(d=>d.language))
              .range(colors)
let arc=d3.arc()
       .outerRadius(150)
       .innerRadius(100)
var p_chart=chart.selectAll("pie")
     .data(pie(data))
     .enter()
     .append("g")
     .attr('transform', 'translate(170,230)')
p_chart.append("path")
     .attr("d",arc)
     .attr("fill",d=>{
       return color_scale(d.data.language);
     })
p_chart.append("text")
      .text(function(d){ return d.data.language})
      .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")";  })
      .style("text-anchor", "middle")
      //const svg = d3.create('svg').attr('viewBox', [0, 0, width, 200]);


</script>

  <%- include ('global/footer');  %>
</body>

</html>
